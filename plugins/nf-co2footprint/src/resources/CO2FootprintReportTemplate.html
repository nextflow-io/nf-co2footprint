<!DOCTYPE html>
<!--
  ~ Copyright 2013-2023, Seqera Labs
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Nextflow workflow report for run id [${workflow.runName}]">
  <meta name="author" content="Sabrina Krakau">
  <link rel="icon" type="image/png" href="https://www.nextflow.io/img/favicon.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <title>[${workflow.runName}] Nextflow CO<sub>2</sub>e Footprint Report</title>

  <style type="text/css">
  ${ assets_css.join("\n\n\n\n") }

  /* Nextflow CO2e Report Custom CSS */
  body {
    padding-top: 56px;
  }
  .navbar-brand img {
    width: 20px;
    height: 20px;
    margin: 0 10px 5px 0;
  }
  pre {
    margin-bottom: 0;
  }
  pre.nfcommand {
    white-space: pre-wrap;
    border: 1px solid #ccc;
    padding: 10px 15px;
    border-radius: 5px;
    background-color: #F0F2F4;
    font-size: 0.8rem;
  }
  table td {
    max-width: 200px;
    overflow-x: auto;
  }
  .script_block.short {
    max-height: 30px;
    overflow-y: hidden;
    cursor: pointer;
  }
  footer {
    background-color: #ededed;
    margin: 50px 0 0;
    padding: 20px 0;
    border-top: 1px solid #cccccc;
    color: #999999;
    font-size: 0.8rem;
  }
  footer a {
    color: #999999;
    text-decoration: underline;
  }
  #nf-form-humanreadable {
    margin-bottom: 1rem;
  }
  #tasks_table_filter {
    display: flex;
  }
  #tasks_table_filter>.btn-group {
    vertical-align: top;
    margin-right: 1rem;
    height: calc(1.8125rem + 3px);
  }
  #tasks_table_filter .buttons-colvisGroup {
    padding: 0.2rem 0.75rem;
  }
  #tasks_table_filter .dt-buttons::before {
    content: "Filter: ";
    padding: 0.2rem 0.5rem;
    font-size: 1.1rem;
  }
  </style>

</head>
<body>
  <nav id="nf-report-navbar" class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="#">
      <img src="data:image/png;base64,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">
      Nextflow CO<sub>2</sub>e Report
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item"><a class="nav-link" href="#">Summary</a></li>
        <li class="nav-item"><a class="nav-link" href="#resources">Resources</a></li>
        <li class="nav-item"><a class="nav-link" href="#tasks">Tasks</a></li>
      </ul>
      <span class="navbar-text">
        [${workflow.runName}]
      </span>
    </div>
  </nav>

  <div class="jumbotron mb-0">
    <div class="container">

      <h1 class="display-3">Nextflow CO<sub>2</sub>e footprint report</h1>
      <h2 class="text-muted mb-4"><samp>[${workflow.runName}]</samp> ${workflow.resume ? '<em>(resumed run)</em>' : ''}</h2>

      <% if ( workflow.success && workflow.stats.ignoredCount ){ %>
          <div class="alert alert-warning mb-4">
              Workflow execution completed successfully. One or more tasks reported an error condition.
          </div>
      <% } else if ( workflow.success ) { %>
          <div class="alert alert-success mb-4">
              Workflow execution completed successfully!
          </div>
      <% } else { %>
          <div class="alert alert-danger mb-4">
              <h4>Workflow execution completed unsuccessfully!</h4>
              <p>The exit status of the task that caused the workflow execution to fail was: <code>${workflow.exitStatus}</code>.</p>
              <p>The full error message was:</p>
              <pre>${workflow.errorReport}</pre>
          </div>
      <% } %>

      <dl>
        <dt>Run times</dt>
        <dd>
          <span id="workflow_start">${workflow.start.format('dd-MMM-yyyy HH:mm:ss')}</span> - <span id="workflow_complete">${workflow.complete.format('dd-MMM-yyyy HH:mm:ss')}</span>
          (<span id="completed_fromnow"></span>duration: <strong>${workflow.duration}</strong>)
        </dd>

        <dt>Nextflow command</dt>
        <dd><pre class="nfcommand"><code>${workflow.commandLine}</code></pre></dd>
      </dl>

      <dl class="row small">
        <dt class="col-sm-3">Nextflow version</dt>
        <dd class="col-sm-9">version ${workflow.nextflow.version}, build ${workflow.nextflow.build} (${workflow.nextflow.timestamp})</dd>
      </dl>

      <h3>Total CO2e footprint measures</h3>
      <div class="row text-center mt-4 mb-5">
        <div class="col-12 col-md-6 col-xl"><div class=" card my-3">
          <span class="display-4">${co2_totals.co2}  g</span>
          <svg class="mx-auto" style="height:50px;"xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="m19.21 12.04l-1.53-.11l-.3-1.5A5.484 5.484 0 0 0 12 6C9.94 6 8.08 7.14 7.12 8.96l-.5.95l-1.07.11A3.99 3.99 0 0 0 2 14c0 2.21 1.79 4 4 4h13c1.65 0 3-1.35 3-3c0-1.55-1.22-2.86-2.79-2.96z" opacity=".3"/><path fill="currentColor" d="M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5c0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4c0-2.05 1.53-3.76 3.56-3.97l1.07-.11l.5-.95A5.469 5.469 0 0 1 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5l1.53.11A2.98 2.98 0 0 1 22 15c0 1.65-1.35 3-3 3z"/></svg>
          <h5>CO<sub>2</sub>e emissions</h5>
        </div></div>
        <div class="col-12 col-md-6 col-xl"><div class=" card my-3">
          <span class="display-4">${co2_totals.energy}  Wh</span>
          <svg class="mx-auto" style="height:50px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><mask id="ipSEnergySocket0"><g fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="4"><path d="M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4S4 12.954 4 24s8.954 20 20 20Zm4-23v-5m-8 5v-5"/><path fill="#fff" d="M24 32a8 8 0 0 0 8-8v-3H16v3a8 8 0 0 0 8 8Z"/><path d="M24 44V32"/></g></mask><path fill="currentColor" d="M0 0h48v48H0z" mask="url(#ipSEnergySocket0)"/></svg>
          <h5>Energy consumption</h5>
        </div></div>
        <div class="col-12 col-md-6 col-xl"><div class=" card my-3">
          <span class="display-4">${co2_totals.tree}</span>
          <svg class="mx-auto" style="height:50px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M378.31 378.49L298.42 288h30.63c9.01 0 16.98-5 20.78-13.06c3.8-8.04 2.55-17.26-3.28-24.05L268.42 160h28.89c9.1 0 17.3-5.35 20.86-13.61c3.52-8.13 1.86-17.59-4.24-24.08L203.66 4.83c-6.03-6.45-17.28-6.45-23.32 0L70.06 122.31c-6.1 6.49-7.75 15.95-4.24 24.08C69.38 154.65 77.59 160 86.69 160h28.89l-78.14 90.91c-5.81 6.78-7.06 15.99-3.27 24.04C37.97 283 45.93 288 54.95 288h30.63L5.69 378.49c-6 6.79-7.36 16.09-3.56 24.26c3.75 8.05 12 13.25 21.01 13.25H160v24.45l-30.29 48.4c-5.32 10.64 2.42 23.16 14.31 23.16h95.96c11.89 0 19.63-12.52 14.31-23.16L224 440.45V416h136.86c9.01 0 17.26-5.2 21.01-13.25c3.8-8.17 2.44-17.47-3.56-24.26z"/></svg>
          <h5>Tree months</h5>
        </div></div>
        <div class="col-12 col-md-6 col-xl"><div class=" card my-3">
          <span class="display-4">${co2_totals.car}</span>
          <svg class="mx-auto" style="height:50px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="m5 11l1.5-4.5h11L19 11m-1.5 5a1.5 1.5 0 0 1-1.5-1.5a1.5 1.5 0 0 1 1.5-1.5a1.5 1.5 0 0 1 1.5 1.5a1.5 1.5 0 0 1-1.5 1.5m-11 0A1.5 1.5 0 0 1 5 14.5A1.5 1.5 0 0 1 6.5 13A1.5 1.5 0 0 1 8 14.5A1.5 1.5 0 0 1 6.5 16M18.92 6c-.2-.58-.76-1-1.42-1h-11c-.66 0-1.22.42-1.42 1L3 12v8a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1h12v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-8l-2.08-6Z"/></svg>
          <h5>Km by car</h5>
        </div></div>
        <div class="col-12 col-md-6 col-xl"><div class=" card my-3">
          <% if (co2_totals.plane_percent) { %>
          <span class="display-4">${co2_totals.plane_percent}%</span>
          <% } %>
          <% if (co2_totals.plane_flights) { %>
          <span class="display-4">${co2_totals.plane_flights}x</span>
          <% } %>
          <svg class="mx-auto" style="height:50px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M20.56 3.91c.59.59.59 1.54 0 2.12l-3.89 3.89l2.12 9.19l-1.41 1.42l-3.88-7.43L9.6 17l.36 2.47l-1.07 1.06l-1.76-3.18l-3.19-1.77L5 14.5l2.5.37L11.37 11L3.94 7.09l1.42-1.41l9.19 2.12l3.89-3.89c.56-.58 1.56-.58 2.12 0Z"/></svg>
          <h5>Flight Paris - London</h5>
        </div></div>
      </div>

      <dl class="row small">
      <p>The calculation of these values is based on the carbon footprint computation method
        developed in the Green Algorithms project: www.green-algorithms.org</p>
      <p>Lannelongue, L., Grealey, J., Inouye, M.,
        Green Algorithms: Quantifying the Carbon Footprint of Computation.
        Adv. Sci. 2021, 2100707. https://doi.org/10.1002/advs.202100707</p>
      </dl>
    </div>
  </div>

  <div class="container">
    <h2 id="resources" style="padding-top: 80px;">CO2e Footprint Measures</h2>
    <p>These plots give an overview of the distribution of resource usage for each process.
      A CO<sub>2</sub> equivalent (CO<sub>2</sub>e) is a metric used to compare the emissions from various greenhouse gases based on their impact on global warming.
      For this, the amounts of other gases are converted to the amount of CO<sub>2</sub> that would have the same impact on global warming (over a 100-year period).
    </p>

    <h4>CO2e</h4>
    <ul class="nav nav-tabs" id="co2eplot_tabs" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="co2eplot_tablink" data-toggle="tab" href="#co2eplot_tabpanel" role="tab" aria-controls="co2eplot_tabpanel" aria-expanded="false">
          Raw Emissions
        </a>
      </li>
    </ul>
    <div class="tab-content" id="co2eplot_tabcontent">
      <div class="tab-pane fade show active" id="co2eplot_tabpanel" role="tabpanel">
        <div id="co2eplot"></div>
      </div>
      <div class="tab-pane fade" id="pctco2eplot_tabpanel" role="tabpanel">
        <div id="pctco2eplot"></div>
      </div>
    </div>

    <h4>Energy consumption</h4>
    <ul class="nav nav-tabs" id="energyplot_tabs" role="tablist">
      <li class="nav-item">
        <a class="nav-link active" id="energyplot_tablink" data-toggle="tab" href="#energyplot_tabpanel" role="tab" aria-controls="energyplot_tabpanel" aria-expanded="false">
          Raw Consumption
        </a>
      </li>
    </ul>
    <div class="tab-content" id="energyplot_tabcontent">
      <div class="tab-pane fade show active" id="energyplot_tabpanel" role="tabpanel">
        <div id="energyplot"></div>
      </div>
      <div class="tab-pane fade" id="pctenergyplot_tabpanel" role="tabpanel">
        <div id="pctenergyplot"></div>
      </div>
    </div>
  </div>


  <div class="container">
    <div id="table-container">
      <h2 id="tasks" style="padding-top: 80px;">Tasks</h2>
      <p>This table shows information about each task in the workflow. Use the search box on the right
        to filter rows for specific values. Clicking headers will sort the table by that value and
        scrolling side to side will reveal more columns.</p>
      <form class="form-inline" id="nf-form-humanreadable">
        <label class="mr-sm-2" for="nf-table-humanreadable">Values shown as:</label>
        <select class="custom-select mb-2 mr-sm-2 mb-sm-0" id="nf-table-humanreadable">
          <option value="true">Human readable</option>
          <option value="false">Raw values</option>
        </select>
      </form>
    </div>
    <div class="container-fluid">
      <table class="table small table-striped" id="tasks_table"></table>
    </div>

    <div id="no-table-container">
      (tasks table omitted because the dataset is too big)
    </div>
  </div>

  <footer>
    <div class="container-fluid">
      Generated by <a href="https://www.nextflow.io" target="_blank">Nextflow</a>, version ${workflow.nextflow.version}
    </div>
  </footer>

  <script type="text/javascript">
  ${ assets_js.join("\n\n\n\n") }

  // Nextflow report data
  window.data = $payload;

  </script>

</body>
</html>
